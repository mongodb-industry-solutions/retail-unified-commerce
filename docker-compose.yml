version: "3.9"

services:
  advanced-search-ms:
    build:
      context: ./backend/advanced-search-ms
      dockerfile: Dockerfile
      # no_cache: true  # Uncomment if needed for fresh build
    image: advanced-search-ms:latest
    container_name: advanced-search-ms
    ports:
      - "8000:8000"
    env_file:
      - ./backend/advanced-search-ms/.env
    restart: unless-stopped
    volumes:
      - ~/.aws/credentials:/root/.aws/credentials:ro
      - ~/.aws/config:/root/.aws/config:ro
      - ~/.aws/sso/cache:/root/.aws/sso/cache:rw

  nextjs-app:
    build:
      context: ./frontend
      dockerfile: Dockerfile
      # no_cache: true
    image: nextjs-app:latest
    container_name: nextjs-app
    ports:
      - "3000:3000"
    restart: unless-stopped
